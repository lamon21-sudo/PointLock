# =====================================================
# Test Environment Configuration
# =====================================================
# Copy this file to .env.test for running integration tests.
# These settings ensure test isolation from dev/prod.

# Node Environment
NODE_ENV=test

# =====================================================
# Database Configuration
# =====================================================
# Use a separate test database to avoid corrupting dev data.
# CRITICAL: This database will be wiped clean before each test run.

# Option 1: Dedicated test database (recommended)
DATABASE_URL="postgresql://postgres:password@localhost:5432/pickrivals_test?schema=public"

# Option 2: Use dev database with test schema (not recommended)
# DATABASE_URL="postgresql://postgres:password@localhost:5432/pickrivals_dev?schema=test"

# =====================================================
# Redis Configuration
# =====================================================
# Tests automatically use Redis DB 15 to avoid collision.
# Only change if your Redis setup differs from dev.

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
# Note: REDIS_DB is forced to 15 in vitest.config.integration.ts

# =====================================================
# JWT Configuration (Not Critical for Integration Tests)
# =====================================================
JWT_SECRET=test-jwt-secret-not-for-production
JWT_EXPIRES_IN=1h
JWT_REFRESH_SECRET=test-refresh-secret-not-for-production
JWT_REFRESH_EXPIRES_IN=7d

# =====================================================
# Server Configuration (Not Used in Integration Tests)
# =====================================================
PORT=4001
HOST=localhost

# =====================================================
# Logging Configuration
# =====================================================
# Set to 'true' to see SQL queries in test output (useful for debugging)
DEBUG_SQL=false

# =====================================================
# External Services (Optional for Integration Tests)
# =====================================================
# Most integration tests mock external services.
# Only needed if testing real API integrations.

# Odds API (optional)
# ODDS_API_KEY=your-test-key
# ODDS_API_URL=https://api.test.example.com

# Push Notifications (optional)
# FCM_PROJECT_ID=test-project
# FCM_PRIVATE_KEY=test-key
# APNS_KEY_ID=test-key

# =====================================================
# Test-Specific Settings
# =====================================================
# These are used by integration test helpers

# Transaction timeout for test transactions (milliseconds)
TEST_TRANSACTION_TIMEOUT=10000

# Maximum time to wait for queue processing (milliseconds)
TEST_QUEUE_TIMEOUT=5000

# =====================================================
# Setup Instructions
# =====================================================
# 1. Copy this file: cp .env.test.example .env.test
# 2. Create test database: psql -U postgres -c "CREATE DATABASE pickrivals_test;"
# 3. Run migrations: DATABASE_URL=<test_db_url> pnpm prisma migrate deploy
# 4. Run tests: pnpm test:integration
# 5. Optional: Start Redis: docker run -d -p 6379:6379 redis
